{% autoescape off %}
<!DOCTYPE html>
<html lang="et">
    <head>
        <meta charset="utf-8" />

        <title>{{ site_name }}</title>

        <link rel="stylesheet" href="/css/screen.css" />

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
        <script src="/javascript/jstorage.min.js" type="text/javascript"></script>

        {% block head %}
        {% endblock %}

        <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-260765-18']);
            _gaq.push(['_trackPageview']);
            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>

    </head>
    <body>
        <section id="main_nav">
            <img src="/images/spinner_menu.gif" class="spinner" />
        </section>

        <section id="content">
        {% block list %}
        {% endblock %}

        {% block content %}
        {% endblock %}
        </section>

        <script type="text/javascript">
            $(document).ready(function(){

                if(window.location.pathname == '/') {
                    $.jStorage.deleteKey('main_menu'); //delete cached menu
                }

                menu = $.jStorage.get('main_menu');
                if(menu){
                    $('#main_nav').html(menu);
                } else {
                    $.ajax({
                        url: '/dashboard/menu',
                        cache: true,
                        success: function(html){
                            $.jStorage.set('main_menu', html);
                            $('#main_nav').html(html);
                        }
                    });
                }


            });
        </script>
    </body>
</html>
{% endautoescape %}