{% extends main_template %}

{% block breadcrumb %}
{% endblock %}

{% block nav %}
{% endblock %}

{% block content %}

<section id="wide_content">

    {% if system_logo %}
    <img src="{{ system_logo }}" alt="logo" style="margin:10px auto; display:block;" />
    {% endif %}

    <h1>{{ str.signin }}</h1>

    <div id="login" class="box">
        <a href="{{ account_login_url }}" style="font-weight:bold; display:block;">{{ str.application_login_with_account }}</a>
    </div>

    <div id="login" class="box" style="margin-bottom:10px;">
        <a id="applicant_pass_show" href="javascript:void(0);" style="font-weight:bold; display:block;">{{ str.application_login_with_password }}</a>
        <div id="applicant_pass_form" style="display:none; padding:10px;">
            {{ str.password }}: <input type="password" id="applicant_pass" name="applicant_pass" /> <a id="applicant_pass_send" href="javascript:void(0);" class="button">{{ str.login }}</a>
        </div>
    </div>

</section>

<script>
    $(document).ready(function(){

        //LOG IN
        $('#applicant_pass_show').click(function() {
            $('#signup_form').hide();
            $('#applicant_pass_form').show();
            $('#applicant_pass').focus();
        });

        $('#applicant_pass_send').click(function() {
            sendPass();
        });

        $('#applicant_pass').keyup(function(e) {
            if(e.keyCode == 13) sendPass();
        });

        function sendPass() {
            if($('#applicant_pass').val()) {
                $.post('/person/signin', { applicant_pass: $('#applicant_pass').val() }, function(data) {
                    if(data == 'OK') {
                        location.href = '/person';
                    } else {
                        $('#applicant_pass_form').effect("shake", { times:3 }, 90);
                        $('#applicant_pass').val('');
                    }
                });
            } else {
                $('#applicant_pass_form').effect("shake", { times:3 }, 90);
            }
        }


    });
</script>

{% endblock %}