{% extends "main.html" %}

{% block head %}
<script src="/javascript/jquery.validate.min.js" type="text/javascript"></script>
{% endblock %}

{% block content %}
<h2>{{ questionary.name.translate }}</h2>

<div class="table">
    {% for q in questionary.questions %}
    <div class="table_row">
        <a href="/questionary/{{ q.key }}" class="table_cell">
            {{ q.name.translate }}
        </a>
        <div class="table_cell">
            {{ q.type }}
        </div>
        <div class="table_cell">
            {{ q.is_mandatory|yesno:"Mandatory,," }}
        </div>
        <div class="table_cell">
            {{ q.is_teacher_specific|yesno:"Teacher specific,," }}
        </div>
        <div class="table_cell">
        </div>
    </div>
    {% endfor %}
    <form id="newform" class="table_row" method="post" action="" >
        <div class="table_cell">
            <input type="text" name="name" placeholder="{{ str.question }}" style="width:300px;" />
        </div>
        <div class="table_cell">
            <select name="type">
                <option value="lickert">{{ str.lickert }}</option>
                <option value="text">{{ str.text }}</option>
            </select>
        </div>
        <div class="table_cell">
            <input type="checkbox" name="mandatory" id="new_mandatory" /><label for="new_mandatory">{{ str.mandatory }}</label>
        </div>
        <div class="table_cell">
            <input type="checkbox" name="teacher_specific" id="new_teacher_specific" /><label for="new_teacher_specific">{{ str.teacher_specific }}</label>
        </div>
        <div class="table_cell">
            <a href="javascript:void();" id="save_new" class="button">{{ str.save }}</a>
        </div>
    </form>
</div>


<script type="text/javascript">
    $(document).ready(function(){

        $("#newform").validate({
            rules: {
                name: {
                    required: true,
                    minlength: 3
                },
            },
            messages: {
                name: {
                    required: "{{ str.form_err_name }}",
                    minlength: jQuery.format("{{ str.form_err_minlength }}")
                },
            },
            submitHandler: function(form) {
   	            form.submit();
            }
        });

        $("#save_new").click(function() {
            $("#newform").submit();
        });

    });
</script>

{% endblock %}